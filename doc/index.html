<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=UTF-8" />
<title>Ruby-Units</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: README</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'><h1>Ruby Units</h1>

<p>Kevin C. Olbrich, Ph.D.</p>

<p><a href="http://www.sciwerks.com">Sciwerks.com</a></p>

<p>Project page: <a href="http://github.com/olbrich/ruby-units">http://github.com/olbrich/ruby-units</a></p>

<h2>Introduction</h2>

<p>Many technical applications make use of specialized calculations at some point.  Frequently, these calculations require unit conversions to ensure accurate results.  Needless to say, this is a pain to properly keep track of, and is prone to numerous errors.</p>

<h2>Solution</h2>

<p>The 'Ruby units' gem is designed so simplify the handling of units for scientific calculations. The units of each quantity are specified when a Unit object is created and the Unit class will handle all subsequent conversions and manipulations to ensure an accurate result.</p>

<h2>Installation:</h2>

<p>This package may be installed using:  <code>gem install ruby-units</code></p>

<h2>Usage:</h2>

<pre class="code"><span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;1&quot;</span><span class='rparen token'>)</span>             <span class='comment val'># constant only</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;mm&quot;</span><span class='rparen token'>)</span>            <span class='comment val'># unit only (defaults to a value of 1)</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;1 mm&quot;</span><span class='rparen token'>)</span>          <span class='comment val'># create a simple unit</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;1 mm/s&quot;</span><span class='rparen token'>)</span>        <span class='comment val'># a compound unit</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;1 mm s^-1&quot;</span><span class='rparen token'>)</span>     <span class='comment val'># in exponent notation</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;1 kg*m^2/s^2&quot;</span><span class='rparen token'>)</span>  <span class='comment val'># complex unit</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>&quot;1 kg m^2 s^-2&quot;</span><span class='rparen token'>)</span> <span class='comment val'># complex unit</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='Unit constant id'>Unit</span><span class='lparen token'>(</span><span class='string val'>&quot;1 mm&quot;</span><span class='rparen token'>)</span>              <span class='comment val'># shorthand</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='string val'>&quot;1 mm&quot;</span><span class='dot token'>.</span><span class='to_unit identifier id'>to_unit</span>            <span class='comment val'># convert string object</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='object identifier id'>object</span><span class='dot token'>.</span><span class='to_unit identifier id'>to_unit</span>            <span class='comment val'># convert any object using object.to_s</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='U constant id'>U</span><span class='string val'>'1 mm'</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='u identifier id'>u</span><span class='string val'>'1 mm'</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='string val'>'1 mm'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='string val'>'1 mm'</span><span class='dot token'>.</span><span class='u identifier id'>u</span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='string val'>'1/4 cup'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>            <span class='comment val'># Rational number </span>
<span class='unit identifier id'>unit</span> <span class='assign token'>=</span> <span class='string val'>'1+1i mm'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>            <span class='comment val'># Complex Number</span>
</pre>

<h2>Rules:</h2>

<ol>
<li>only 1 quantity per unit (with 2 exceptions... 6'5" and '8 lbs 8 oz')</li>
<li>use SI notation when possible</li>
<li>avoid using spaces in unit names</li>
</ol>


<h2>Unit compatability:</h2>

<p>Many methods require that the units of two operands are compatible.  Compatible units are those that can be easily converted into each other, such as 'meters' and 'feet'.</p>

<pre class="code"><span class='unit1 identifier id'>unit1</span> <span class='match op'>=~</span> <span class='unit2 identifier id'>unit2</span>   <span class='comment val'>#=&gt; true if units are compatible</span>
</pre>

<h2>Unit Math:</h2>

<pre class="code"><span class='Unit constant id'>Unit</span><span class='comment val'>#+()      # Add. only works if units are compatible</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#-()      # Subtract. only works if units are compatible</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#*()      # Multiply.  </span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#/()      # Divide.</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#**()     # Exponentiate.  Exponent must be an integer, can be positive,  negative, or zero                        </span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#inverse  # Returns 1/unit</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#abs      # Returns absolute value of the unit quantity.  Strips off the  units</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#ceil     # rounds quantity to next highest integer</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#floor    # rounds quantity down to next lower integer</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#round    # rounds quantity to nearest integer</span>
<span class='Unit constant id'>Unit</span><span class='comment val'>#to_int   # returns the quantity as an integer</span>
</pre>

<p>Unit will coerce other objects into a Unit if used in a formula.  This means that ..</p>

<pre class="code"><span class='Unit constant id'>Unit</span><span class='lparen token'>(</span><span class='string val'>&quot;1 mm&quot;</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>&quot;2 mm&quot;</span>  <span class='eq op'>==</span> <span class='Unit constant id'>Unit</span><span class='lparen token'>(</span><span class='string val'>&quot;3 mm&quot;</span><span class='rparen token'>)</span>
</pre>

<p>This will work as expected so long as you start the formula with a Unit object.</p>

<h2>Conversions &amp; comparisons</h2>

<p>Units can be converted to other units in a couple of ways.</p>

<pre class="code"><span class='unit1 identifier id'>unit1</span> <span class='assign token'>=</span> <span class='unit identifier id'>unit</span> <span class='rshft op'>&gt;&gt;</span> <span class='string val'>&quot;ft&quot;</span>   <span class='comment val'># convert to 'feet'</span>
<span class='unit identifier id'>unit</span> <span class='opasgn op'>&gt;&gt;=</span> <span class='string val'>&quot;ft&quot;</span>          <span class='comment val'># convert and overwrite original object</span>
<span class='unit3 identifier id'>unit3</span> <span class='assign token'>=</span> <span class='unit1 identifier id'>unit1</span> <span class='plus op'>+</span> <span class='unit2 identifier id'>unit2</span>  <span class='comment val'># resulting object will have the units of unit1</span>
<span class='unit3 identifier id'>unit3</span> <span class='assign token'>=</span> <span class='unit1 identifier id'>unit1</span> <span class='minus op'>-</span> <span class='unit2 identifier id'>unit2</span>  <span class='comment val'># resulting object will have the units of unit1</span>
<span class='unit1 identifier id'>unit1</span> <span class='cmp op'>&lt;=&gt;</span> <span class='unit2 identifier id'>unit2</span>        <span class='comment val'># does comparison on quantities in base units, throws an exception if not compatible</span>
<span class='unit1 identifier id'>unit1</span> <span class='eqq op'>===</span> <span class='unit2 identifier id'>unit2</span>        <span class='comment val'># true if units and quantity are the same, even if 'equivalent' by &lt;=&gt;</span>
<span class='unit identifier id'>unit</span><span class='dot token'>.</span><span class='to identifier id'>to</span><span class='lparen token'>(</span><span class='string val'>'ft'</span><span class='rparen token'>)</span>          <span class='comment val'># convert</span>
<span class='unit1 identifier id'>unit1</span> <span class='plus op'>+</span> <span class='unit2 identifier id'>unit2</span> <span class='rshft op'>&gt;&gt;</span> <span class='string val'>&quot;ft&quot;</span>  <span class='comment val'># converts result of math to 'ft'</span>
<span class='lparen token'>(</span><span class='unit1 identifier id'>unit1</span> <span class='plus op'>+</span> <span class='unit2 identifier id'>unit2</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to identifier id'>to</span><span class='lparen token'>(</span><span class='string val'>'ft'</span><span class='rparen token'>)</span> <span class='comment val'># converts result to 'ft'</span>
</pre>

<p>Any object that defines a 'to_unit' method will be automatically coerced to a unit during calculations.</p>

<h2>Text Output</h2>

<p>Units will display themselves nicely based on the preferred abbreviation for the units and prefixes.
Since Unit implements a Unit#to_s, all that is needed in most cases is:</p>

<pre class="code"><span class='dstring node'>&quot;#{Unit.new('1 mm')}&quot;</span>  <span class='comment val'>#=&gt; &quot;1 mm&quot;</span>
</pre>

<p>The to_s also accepts some options.</p>

<pre class="code"><span class='Unit constant id'>Unit</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='string val'>'1.5 mm'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='string val'>&quot;%0.2f&quot;</span><span class='rparen token'>)</span>  <span class='comment val'># &quot;1.50 mm&quot;.  Enter any valid format</span>
                                  <span class='string identifier id'>string</span><span class='dot token'>.</span>  <span class='Also constant id'>Also</span> <span class='accepts identifier id'>accepts</span> <span class='strftime identifier id'>strftime</span> <span class='format identifier id'>format</span>
<span class='U constant id'>U</span><span class='lparen token'>(</span><span class='string val'>'1.5 mm'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='string val'>&quot;in&quot;</span><span class='rparen token'>)</span>     <span class='comment val'># converts to inches before printing</span>
<span class='U constant id'>U</span><span class='lparen token'>(</span><span class='string val'>&quot;2 m&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='symbol val'>:ft</span><span class='rparen token'>)</span>         <span class='comment val'># returns 6'7&quot;</span>
<span class='U constant id'>U</span><span class='lparen token'>(</span><span class='string val'>&quot;100 kg&quot;</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='lparen token'>(</span><span class='symbol val'>:lbs</span><span class='rparen token'>)</span>     <span class='comment val'># returns 220 lbs, 7 oz</span>
</pre>

<h2>Time Helpers</h2>

<p>Time, Date, and DateTime objects can have time units added or subtracted.</p>

<pre class="code"><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span> <span class='plus op'>+</span> <span class='string val'>&quot;10 min&quot;</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> 
</pre>

<p>Several helpers have also been defined.
Note: If you include the 'Chronic' gem, you can specify times in natural</p>

<pre class="code">  <span class='language identifier id'>language</span><span class='dot token'>.</span>

  <span class='string val'>'min'</span><span class='dot token'>.</span><span class='since identifier id'>since</span><span class='lparen token'>(</span><span class='string val'>'9/18/06 3:00pm'</span><span class='rparen token'>)</span>
  <span class='string val'>'min'</span><span class='dot token'>.</span><span class='before identifier id'>before</span><span class='lparen token'>(</span><span class='string val'>'9/18/08 3:00pm'</span><span class='rparen token'>)</span>
  <span class='string val'>'days'</span><span class='dot token'>.</span><span class='until identifier id'>until</span><span class='lparen token'>(</span><span class='string val'>'1/1/07'</span><span class='rparen token'>)</span>
  <span class='string val'>'5 min'</span><span class='dot token'>.</span><span class='from identifier id'>from</span><span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='rparen token'>)</span>
  <span class='string val'>'5 min'</span><span class='dot token'>.</span><span class='from_now identifier id'>from_now</span>
  <span class='string val'>'5 min'</span><span class='dot token'>.</span><span class='before_now identifier id'>before_now</span>
  <span class='string val'>'5 min'</span><span class='dot token'>.</span><span class='before identifier id'>before</span><span class='lparen token'>(</span><span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='now identifier id'>now</span><span class='rparen token'>)</span>
  <span class='string val'>'10 min'</span><span class='dot token'>.</span><span class='ago identifier id'>ago</span>
</pre>

<p>Durations may be entered as 'HH:MM:SS, usec' and will be returned in 'hours'.</p>

<pre class="code"><span class='string val'>'1:00'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='comment val'>#=&gt; 1 h</span>
<span class='string val'>'0:30'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='comment val'>#=&gt; 0.5 h</span>
<span class='string val'>'0:30:30'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='comment val'>#=&gt; 0.5 h + 30 sec</span>
</pre>

<p>If only one ":" is present, it is interpreted as the separator between hours and minutes.</p>

<h2>Ranges</h2>

<pre class="code"><span class='lbrack token'>[</span><span class='U constant id'>U</span><span class='lparen token'>(</span><span class='string val'>'0 h'</span><span class='rparen token'>)</span><span class='dot2 op'>..</span><span class='U constant id'>U</span><span class='lparen token'>(</span><span class='string val'>'10 h'</span><span class='rparen token'>)</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='x identifier id'>x</span><span class='bitor op'>|</span> <span class='p identifier id'>p</span> <span class='x identifier id'>x</span><span class='rbrace token'>}</span>
</pre>

<p>works so long as the starting point has an integer scalar</p>

<h2>Math functions</h2>

<p>All Trig math functions (sin, cos, sinh, hypot...) can take a unit as their parameter.  It will be converted to radians and then used if possible.</p>

<h2>Temperatures</h2>

<p>Ruby-units makes a distinction between a temperature (which technically is a property) and degrees of temperature (which temperatures are measured in).</p>

<p>Temperature units (i.e., 'tempK') can be converted back and forth, and will take into account the differences in the zero points of the various scales. Differential temperature (e.g., '100 degC'.unit) units behave like most other units.</p>

<pre class="code"><span class='string val'>'37 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='rshft op'>&gt;&gt;</span> <span class='string val'>'tempF'</span> <span class='comment val'>#=&gt; 98.6 tempF</span>
</pre>

<p>Ruby-units will raise an exception if you attempt to create a temperature unit that would fall below absolute zero.</p>

<p>Unit math on temperatures is fairly limited.<br/>
</p>

<pre class="code"><span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='plus op'>+</span> <span class='string val'>'10 degC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>   <span class='comment val'># '110 tempC'.unit</span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='minus op'>-</span> <span class='string val'>'10 degC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>   <span class='comment val'># '90 tempC'.unit</span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='plus op'>+</span> <span class='string val'>'50 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>  <span class='comment val'># exception  </span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='minus op'>-</span> <span class='string val'>'50 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>  <span class='comment val'># '50 degC'.unit</span>
<span class='string val'>'50 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='minus op'>-</span> <span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span>  <span class='comment val'># '-50 degC'.unit</span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='mult op'>*</span> <span class='lbrack token'>[</span><span class='scalar identifier id'>scalar</span><span class='rbrack token'>]</span>         <span class='comment val'># '100*scalar tempC'.unit</span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='div op'>/</span> <span class='lbrack token'>[</span><span class='scalar identifier id'>scalar</span><span class='rbrack token'>]</span>         <span class='comment val'># '100/scalar tempC'.unit</span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='mult op'>*</span> <span class='lbrack token'>[</span><span class='unit identifier id'>unit</span><span class='rbrack token'>]</span>           <span class='comment val'># exception</span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='div op'>/</span> <span class='lbrack token'>[</span><span class='unit identifier id'>unit</span><span class='rbrack token'>]</span>           <span class='comment val'># exception</span>
<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='pow op'>**</span> <span class='N constant id'>N</span>               <span class='comment val'># exception</span>

<span class='string val'>'100 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='rshft op'>&gt;&gt;</span> <span class='string val'>'degC'</span>          <span class='comment val'>#=&gt; '100 degC'.unit   </span>
</pre>

<p>This conversion references the 0 point on the scale of the temperature unit</p>

<pre class="code"><span class='string val'>'100 degC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='rshft op'>&gt;&gt;</span> <span class='string val'>'tempC'</span>          <span class='comment val'>#=&gt; '-173 tempC'.unit</span>
</pre>

<p>These conversions are always interpreted as being relative to absolute zero.
Conversions are probably better done like this...</p>

<pre class="code"><span class='string val'>'0 tempC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='plus op'>+</span> <span class='string val'>'100 degC'</span><span class='dot token'>.</span><span class='unit identifier id'>unit</span> <span class='comment val'>#=&gt; '100 tempC'.unit</span>
</pre></div></div>
    
    <div id="footer">
  Generated on Wed Mar 17 02:01:09 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>
  0.5.3 (ruby-1.8.7).
</div>

  </body>
</html>